---
keywords: fastai
description: Interactively render the Juliaset as a lambda function in BigDataViewer
title: Juliaset Lambda
toc: false
branch: master
badges: true
comments: true
author: Stephan Saalfeld
categories: [imglib2, lambda, fractal, juliaset, bigdataviewer]
nb_path: _notebooks/2022-05-02-juliaset-lambda.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-05-02-juliaset-lambda.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import dependencies.  BigDataViewer Vistools is the convenience API that we use to display the results of our experiments and it includes all ImgLib2 related dependencies that we need.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="o">%%</span><span class="n">loadFromPOM</span>
<span class="o">&lt;</span><span class="n">repository</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span><span class="n">scijava</span><span class="p">.</span><span class="na">public</span><span class="o">&lt;/</span><span class="n">id</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span><span class="n">https</span><span class="p">:</span><span class="c1">//maven.scijava.org/content/groups/public&lt;/url&gt;</span>
<span class="o">&lt;/</span><span class="n">repository</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">sc</span><span class="p">.</span><span class="na">fiji</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">bigdataviewer</span><span class="o">-</span><span class="n">vistools</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">1.0.0</span><span class="o">-</span><span class="n">beta</span><span class="o">-</span><span class="mi">29</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We define the Juliaset as a function in 2D real space using a <code>BiConsumer</code> lambda.  The <code>BiConsumer</code> receives two parameters, the first one (x) is the 2D coordinate, the second one (y) is the target of the function whose value will be set in place, here we use an <code>IntType</code>.  We also have to provide a <code>Supplier</code> for instances of the target such that multiple threads can each create their own.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kn">import</span> <span class="nn">bdv.util.*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.imglib2.position.FunctionRealRandomAccessible</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.imglib2.type.numeric.integer.IntType</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.imglib2.util.Intervals</span><span class="p">;</span>

<span class="kd">var</span> <span class="n">juliaset</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FunctionRealRandomAccessible</span><span class="o">&lt;&gt;</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="na">getDoublePosition</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">d</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="na">getDoublePosition</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">127</span> <span class="o">&amp;&amp;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">4096</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">final</span> <span class="kt">double</span> <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">d</span><span class="p">;</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">d</span><span class="p">;</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">;</span>
            <span class="n">d</span> <span class="o">+=</span> <span class="mf">0.6</span><span class="p">;</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="na">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">d</span><span class="p">);</span>
            <span class="o">++</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">y</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="n">IntType</span><span class="p">::</span><span class="k">new</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we show this function with BigDataViewer.  Use your mouse and keyboard to zoom in until you reach the precision limit of <code>double</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">BdvFunctions</span><span class="p">.</span><span class="na">show</span><span class="p">(</span>
    <span class="n">juliaset</span><span class="p">,</span>
    <span class="n">Intervals</span><span class="p">.</span><span class="na">createMinMax</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s">&quot;&quot;</span><span class="p">,</span>
    <span class="n">BdvOptions</span><span class="p">.</span><span class="na">options</span><span class="p">().</span><span class="na">is2D</span><span class="p">()).</span><span class="na">setDisplayRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cool?  I think so!  Now let's embed one of the two parameters of the Juliaset as a third dimension.  The code is almost the same except that we introduce a a variable a.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span> <span class="n">juliaset3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FunctionRealRandomAccessible</span><span class="o">&lt;&gt;</span><span class="p">(</span>
    <span class="mi">3</span><span class="p">,</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="na">getDoublePosition</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">d</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="na">getDoublePosition</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="na">getDoublePosition</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">127</span> <span class="o">&amp;&amp;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">4096</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">final</span> <span class="kt">double</span> <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">d</span><span class="p">;</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">d</span><span class="p">;</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
            <span class="n">d</span> <span class="o">+=</span> <span class="mf">0.6</span><span class="p">;</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="na">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">d</span><span class="p">);</span>
            <span class="o">++</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">y</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="n">IntType</span><span class="p">::</span><span class="k">new</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we show this as a 3D volume in BigDataViewer.  You can scroll through the 'z'-dimension or arbitrarily slice through the 3D volume.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">BdvFunctions</span><span class="p">.</span><span class="na">show</span><span class="p">(</span>
    <span class="n">juliaset3</span><span class="p">,</span>
    <span class="n">Intervals</span><span class="p">.</span><span class="na">createMinMax</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s">&quot;Juliaset3&quot;</span><span class="p">,</span>
    <span class="n">BdvOptions</span><span class="p">.</span><span class="na">options</span><span class="p">()).</span><span class="na">setDisplayRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

